<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta charset="UTF-8" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/docsify/lib/themes/dark.min.css"
    />
  </head>
  <body>
    <nav>
      <a href="/">Home</a>
      <a href="https://hackintosh.club">Hackintosh.Club</a>
    </nav>
    <div id="app">Please wait...</div>
    <script>
      window.H8H = {
        cdn: "https://cdn.jsdelivr.net/gh/hackintosh-club",
      };
      window.$docsify = {
        repo: "https://github.com/hackintosh-club",
        name: "<strong>Hackintosh EFI</strong>",
        onlyCover: true,
        coverpage: true,
        loadSidebar: true,
        autoHeader: true,
        nativeEmoji: true,
        routerMode: "history",
        themeColor: "#F36322",
        alias: {
          "/r/_sidebar.md": "/_sidebar.md",
          "/r/(.*)": H8H.cdn + "/$1/README.md",
        },
      };

      (function () {
        var h8hPlugin = function (hook, vm) {
          // Invoked one time when docsify script is initialized
          hook.init(function () {
            console.log("hook.init");
          });

          // Invoked one time when the docsify instance has mounted on the DOM
          hook.mounted(function () {
            console.log("hook.mounted");
          });

          // Invoked on each page load before new markdown is transformed to HTML.
          // Supports asynchronous tasks (see beforeEach documentation for details).
          hook.beforeEach(function (markdown) {
            console.log("hook.beforeEach");
            if (!vm.route.path.startsWith("/r")) {
              return markdown;
            }
            const baseURL = H8H.cdn + vm.route.path.replace("/r", "") + "/";
            console.log("baseURL", baseURL);
            // Replace image src attributes
            markdown = markdown.replace(
              /!\[.*?\]\((?!http)(.*?)\)/g,
              (match, p1) => {
                return `![${match
                  .match(/\!\[.*?\]/)[0]
                  .slice(2, -1)}](${baseURL}${p1})`;
              }
            );
            // delete README
            markdown = markdown.replace(
              /(#+)\s*\[.*?\]\(README.*?\.md\)\s*$/gm,
              ""
            );
            return markdown;
          });

          // Invoked on each page load after new markdown has been transformed to HTML.
          // Supports asynchronous tasks (see afterEach documentation for details).
          hook.afterEach(function (html) {
            console.log("hook.afterEach");
            return html;
          });

          // Invoked on each page load after new HTML has been appended to the DOM
          hook.doneEach(function () {
            console.log("hook.doneEach");
          });

          // Invoked one time after rendering the initial page
          hook.ready(function () {
            console.log("hook.ready");
          });
        };

        // Add plugin to docsify's plugin array
        $docsify = $docsify || {};
        $docsify.plugins = [].concat(h8hPlugin, $docsify.plugins || []);
      })();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/docsify/lib/docsify.min.js"></script>
  </body>
</html>
